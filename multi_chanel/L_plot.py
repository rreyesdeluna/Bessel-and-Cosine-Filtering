import os
import sys
import numpy                as np
import plotly.graph_objects as go
import plotly.express       as px

xvec = [50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70, 72, 74, 76, 78, 80, 82, 84, 86, 88, 90, 92, 94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116, 118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140, 142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164, 166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188, 190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212, 214, 216, 218, 220, 222, 224, 226, 228, 230, 232, 234, 236, 238, 240, 242, 244, 246, 248, 250, 252, 254, 256, 258, 260, 262, 264, 266, 268, 270, 272, 274, 276, 278, 280, 282, 284, 286, 288, 290, 292, 294, 296, 298, 300, 302, 304, 306, 308, 310, 312, 314, 316, 318, 320, 322, 324, 326, 328, 330, 332, 334, 336, 338, 340, 342, 344, 346, 348, 350, 352, 354, 356, 358, 360, 362, 364, 366, 368, 370, 372, 374, 376, 378, 380, 382, 384, 386, 388, 390, 392, 394, 396, 398, 400, 402, 404, 406, 408, 410, 412, 414, 416, 418, 420, 422, 424, 426, 428, 430, 432, 434, 436, 438, 440, 442, 444, 446, 448, 450, 452, 454, 456, 458, 460, 462, 464, 466, 468, 470, 472, 474, 476, 478, 480, 482, 484, 486, 488, 490, 492, 494, 496, 498, 500, 502, 504, 506, 508, 510, 512, 514, 516, 518, 520, 522, 524, 526, 528, 530, 532, 534, 536, 538, 540, 542, 544, 546, 548, 550, 552, 554, 556, 558, 560, 562, 564, 566, 568, 570, 572, 574, 576, 578, 580, 582, 584, 586, 588, 590, 592, 594, 596, 598, 600, 602, 604, 606, 608, 610, 612, 614, 616, 618, 620, 622, 624, 626, 628, 630, 632, 634, 636, 638, 640, 642, 644, 646, 648, 650, 652, 654, 656, 658, 660, 662, 664, 666, 668, 670, 672, 674, 676, 678, 680, 682, 684, 686, 688, 690, 692, 694, 696, 698, 700, 702, 704, 706, 708, 710, 712, 714, 716, 718, 720, 722, 724, 726, 728, 730, 732, 734, 736, 738, 740, 742, 744, 746, 748, 750, 752, 754, 756, 758, 760, 762, 764, 766, 768, 770, 772, 774, 776, 778, 780, 782, 784, 786, 788, 790, 792, 794, 796, 798, 800, 802, 804, 806, 808, 810, 812, 814, 816, 818, 820, 822, 824, 826, 828, 830, 832, 834, 836, 838, 840, 842, 844, 846, 848, 850, 852, 854, 856, 858, 860, 862, 864, 866, 868, 870, 872, 874, 876, 878, 880, 882, 884, 886, 888, 890, 892, 894, 896, 898]
res_enrgy1b = [98.6939771109325, 98.76941496846828, 98.83789488057631, 98.89999361413193, 98.95628284922213, 99.00732482748363, 99.05366753225202, 99.0958395969764, 99.13434509040879, 99.1696583109564, 99.2022187250772, 99.23242619500449, 99.26063665146965, 99.28715837205844, 99.31224902222375, 99.33611360257404, 99.35890342325003, 99.38071619560385, 99.40159729540436, 99.42154221317462, 99.44050016875804, 99.45837883117264, 99.47505005304214, 99.49035650246309, 99.50411905444983, 99.51614478881804, 99.52623543074225, 99.53419606315639, 99.53984393542304, 99.54301718910158, 99.54358331825502, 99.541447177971, 99.5365583505453, 99.52891767452616, 99.51858273853603, 99.50567214096544, 99.49036832012821, 99.4729187693414, 99.45363546965625, 99.4328924013077, 99.41112103444554, 99.38880375056765, 99.36646520743454, 99.3446617300903, 99.3239688858217, 99.30496747739693, 99.28822826206002, 99.27429576863909, 99.26367163713475, 99.25679794039037, 99.25404096312796, 99.25567590838423, 99.26187297536305, 99.27268520762094, 99.28803844937562, 99.30772367469535, 99.33139187423303, 99.35855160215598, 99.38856920703881, 99.42067169930145, 99.45395214807722, 99.48737745491296, 99.51979832195123, 99.54996121838839, 99.57652214984678, 99.59806204831882, 99.61310362182743, 99.62012952823157, 99.61760176140014, 99.60398215480066, 99.57775391224824, 99.53744406386001, 99.481646714339, 99.40904689965873, 99.31844479841575, 99.20877995933522, 99.0791551127366, 98.92885903917336, 98.75738788221173, 98.56446422410002, 98.3500532021074, 98.11437493733186, 97.85791258232065, 97.58141537154545, 97.28589617910835, 96.97262324725253, 96.64310594063953, 96.29907459582176, 95.9424547620775, 95.57533635704189, 95.19993847649009, 94.81857079091279, 94.43359262206847, 94.04737091203734, 93.66223836894672, 93.28045309313532, 92.90416095298937, 92.53536189120408, 92.1758812022649, 92.2568441247106, 92.32782061847833, 92.36371037617336, 92.36189644366755, 92.32007576095343, 92.23627584253128, 92.10886499990502, 91.93655659253811, 91.71840802557618, 91.45381538382784, 91.14250469208459, 90.78452081706521, 90.38021497688128, 89.93023170638769, 89.43549595283534, 88.89720076192441, 88.31679577873155, 88.19184177576052, 88.1106711422689, 88.04236734875408, 87.98662959083853, 87.94315071808856, 87.91160364030814, 87.89162655092503, 87.88280790428522, 87.88467204587849, 87.89666631708778, 87.91815034727837, 87.94838811472107, 87.98654321255327, 88.03167760447268, 88.08275400369483, 88.13864186307147, 88.19812682802927, 88.25992337987569, 88.32269028687925, 88.38504838570358, 88.44560013733376, 88.50295034067592, 88.55572734472449, 88.60260407791868, 88.64231821237341, 88.67369080220774, 88.69564277983967, 88.70720876173566, 88.70754770452601, 88.69595006122833, 88.67184121192993, 88.63478107884538, 88.58445997643622, 88.52069088693703, 88.44339848369394, 88.35260534305428, 88.24841588478385, 88.13099865691969, 88.00056763079169, 87.85736319441409, 87.70163352779633, 87.53361701360316, 87.35352628372586, 87.16153443029198, 86.95776382244411, 86.74227787204974, 86.51507598641649, 86.27609183780892, 86.0251949713821, 85.7621956678538, 85.48685287717042, 85.19888494652939, 84.89798278209001, 84.58382501006868, 84.25609464114702, 83.91449669372057, 83.55877619796952, 83.18873598553, 82.80425366998713, 82.40529724254093, 81.99193874552361, 81.56436554384037, 81.12288878985747, 80.667948768831, 80.20011691670943, 79.72009441621894, 79.22870739591056, 78.72689887523323, 78.21571771138636, 77.69630490562942, 77.1698777133256, 76.6377120696159, 76.10112388869821, 75.56144981793656, 75.02002802843464, 74.47817960247221, 73.93719103755826, 74.5159933034197, 75.09650442254627, 75.67401357437517, 76.24743886126566, 76.8156309962181, 77.37736733218395, 77.93134905488294, 78.47620179663771, 79.01047980829767, 79.53267369910381, 80.04122162427144, 80.5345236712685, 81.01095907249217, 81.46890575869456, 81.90676166849364, 82.32296714897147, 82.7160277247023, 83.08453648103236, 83.42719530463049, 83.74283425170292, 84.03042837187297, 84.28911140209038, 84.5181858569535, 84.717129174894, 84.8855957278474, 85.02341465843287, 85.13058366586222, 85.20725901235504, 85.25374215878074, 85.27046355554046, 85.25796420759826, 85.2168756978671, 85.14789938927125, 85.05178553275661, 84.92931298774846, 84.78127021566446, 84.60843813952944, 84.41157537750259, 84.1914062593794, 83.94861192704741, 83.6838247063387, 83.39762582232618, 83.09054641602685, 82.76307171055653, 82.41564807156855, 82.04869261267015, 81.66260491367966, 81.25778035023232, 80.83462447949057, 80.39356789053691, 79.93508091121785, 79.45968756714275, 78.9679782140307, 78.46062031169721, 78.2519882729709, 78.51823332924785, 78.77425241858263, 79.02004086957541, 79.25563831632904, 79.48112891830984, 79.69663875275141, 79.90233042667164, 80.09839507050518, 80.28504198484386, 80.46248631075211, 80.63093517818902, 80.79057285268657, 80.94154544517784, 81.08394577242277, 81.21779895564661, 81.34304932358249, 81.45954914469856, 81.5670496542079, 81.66519476713428, 81.75351778207435, 81.83144128428643, 81.89828035426859, 81.95324908192758, 81.99547027963277, 82.0239881827055, 82.03778382607825, 82.03579269387417, 82.03338613583537, 82.52921010565407, 82.97799788881174, 83.37743713888271, 83.72542715310023, 84.0200996785353, 84.25983624765146, 84.44328202480351, 84.56935624277224, 84.63725938221452, 84.64647729491332, 84.59678249414216, 84.48823283472265, 84.3211677857384, 84.09620246608857, 83.81421957368204, 83.47635929985474, 83.084007287854, 82.63878067328673, 82.29755379819754, 82.1335430513508, 81.94524999777866, 81.73390309016473, 81.50071852963042, 81.24688521972249, 80.97355214981438, 80.6818185011925, 80.37272666879578, 80.04725828905875, 79.70633326264834, 79.35081166279755, 78.98149832785516, 78.59914985275945, 78.20448362037561, 77.79818845182011, 77.38093640671693, 76.95339523127934, 76.63156718175809, 76.37037018775969, 76.10142117481486, 75.8246217263812, 75.5398784373797, 75.24711172336441, 74.94626276214643, 74.91294282417152, 75.47368294573364, 76.02525436890885, 76.56657959094585, 77.09667022606462, 77.61462665034949, 78.11963471931442, 78.61095977412339, 79.08793825875618, 79.54996736273162, 79.99649317839553, 80.4269979153813, 80.84098674598323, 81.23797486331154, 81.61747531973941, 81.97898817774248, 82.32199145086786, 82.64593424188843, 82.95023240113696, 83.23426693367517, 83.49738528252895, 83.73890550987807, 83.95812329198812, 84.15432153994867, 84.32678236001041, 84.47480097760196, 84.59770117092755, 84.69485169631233, 84.76568314081632, 84.80970461039242, 84.8265196557824, 84.8158408545101, 84.7775025059578, 84.71147095682892, 84.61785215448823, 84.49689612284378, 84.34899816575336, 84.17469672175558, 83.97466791606519, 83.74971697578505, 83.50076678685888, 83.22884397147288, 82.935062948234, 82.62060850125944, 82.28671742617917, 81.93465984004308, 81.5657207384309, 81.1811823579401, 80.78230785778241, 80.37032677321574, 79.94642261916651, 79.51172293805197, 79.06729199490226, 78.61412622868362, 78.15315247430173, 77.68522887787735, 77.21114834102478, 76.73164425024723, 76.24739817714679, 75.75904917570193, 75.26720425594185, 74.77244958027991, 75.22008018236549, 75.75501455528423, 76.28416589535692, 76.80587574784894, 77.3185186196937, 77.82051990139152, 78.31037238946317, 78.7866508869775, 79.24802442001892, 79.69326569005942, 80.12125748276691, 80.53099586836717, 80.92159015192681, 81.29225965795041, 81.64232755646401, 81.97121205151325, 82.27841535260856, 82.56351093087817, 82.82612962143564, 83.06594516987262, 83.28265983314766, 83.47599063393044, 83.6456568340628, 83.79136913937951, 83.9128210773961, 84.00968290438222, 84.08159830232346, 84.12818402256215, 84.14903252475602, 84.14371755045988, 84.11180246327939, 84.0528510852763, 83.9664406651894, 83.85217653104465, 83.70970791075524, 83.53874435201509, 83.3390721395513, 83.11057009552582, 82.85322415883849, 82.56714017179779, 82.2525543576371, 81.90984104822569, 81.53951731552382, 81.1422442693467]
res_enrgy1c = [85.94564157907885, 88.14773332551282, 89.96210310088199, 91.45881750160808, 92.69659784414928, 93.7235990859665, 94.57878091066526, 95.29341591229753, 95.89251147027852, 96.39605370280806, 96.82005102907765, 97.17738765785057, 97.47851034725261, 97.73386628839388, 97.97790525751728, 98.18881195199283, 98.37153502854584, 98.53022898451455, 98.66841666316922, 98.78911424191857, 98.89492639663806, 98.98811786391161, 99.07066647155351, 99.14430180289934, 99.2105329417955, 99.27066816538256, 99.32582897341679, 99.37696043682504, 99.42483949178634, 99.4700824821324, 99.51315295133489, 99.55437040068685, 99.59392046279473, 99.63186669387986, 99.66816397211294, 99.70267331056928, 99.73517775954707, 99.76539898837375, 99.79301410219281, 99.81767226135247, 99.83901072304609, 99.85667000702202, 99.87030798781669, 99.87961282246559, 99.88431472244869, 99.88419665994817, 99.87910415113578, 99.86895427512317, 99.85374406124775, 99.83355830785176, 99.80857678509854, 99.77908062968716, 99.74545757248556, 99.7082054677977, 99.6679334361632, 99.62535981533367, 99.58130606175037, 99.53668578153423, 99.49248821514325, 99.44975576440962, 99.40955553313012, 99.3729453353636, 99.34093517392427, 99.3144457528919, 99.29426609661616, 99.28101273213534, 99.27509308524104, 99.27667569227388, 99.28566951753962, 99.30171410275108, 99.32418151004781, 99.35219013581184, 99.38462957089773, 99.42019487053297, 99.45742796780488, 99.49476358486281, 99.53057689592781, 99.5632303674612, 99.59111760062225, 99.61270256162518, 99.62655322586687, 99.63136929984145, 99.62600424841706, 99.60948228851096, 99.58101127922401, 99.5399925310856, 99.48602848213636, 99.41892897269466, 99.33871653348021, 99.24563073090323, 99.14013123901822, 99.02289897773036, 98.89483441242393, 98.75705198208604, 98.61086962942075, 98.457792551687, 98.29949056543367, 98.13776885946017, 97.9745323649954, 98.00441102231869, 98.24104306921413, 98.45786386352027, 98.65306422583444, 98.82502200767046, 98.97231843128486, 99.09374944902835, 99.18833134628609, 99.25530022818015, 99.29410546007055, 99.30439754356969, 99.28601127501206, 99.23894532930701, 99.16333962260573, 99.05945192297261, 98.92763519672853, 98.7683171027712, 98.581982886368, 98.36916268980967, 98.13042400474508, 97.8663696565395, 97.57764135218066, 97.26492845816959, 96.92898132168098, 96.60035769021522, 96.62531590294111, 96.6475482740056, 96.66640913670864, 96.68142241154733, 96.69228736558748, 96.69888080766442, 96.70125549027703, 96.6996344646504, 96.69440116893982, 96.68608512807133, 96.67534330528126, 96.66293735871501, 96.64970730186393, 96.63654231841706, 96.62434971154889, 96.6140231466496, 96.60641145129725, 96.60228925069293, 96.60233063448244, 96.607086876299, 96.61696897521954, 96.63223548187672, 96.73209622879672, 97.01222273297104, 97.25475659025405, 97.45949664597339, 97.62638626958407, 97.75549352612555, 97.84699286495527, 97.90114914270704, 97.91830452530232, 97.89886852486212, 97.84331114304157, 97.75215883182506, 97.62599276210585, 97.46544872143674, 97.27121785301614, 97.2731150698367, 97.29309329561049, 97.30402672939734, 97.30479308627477, 97.29431758728046, 97.27158659685038, 97.23566096985505, 97.18568852587951, 97.12091501918249, 97.04069298470019, 96.9444879143945, 96.83188134868541, 96.70257064344379, 96.55636537840329, 96.39318058940698, 96.2130272153305, 96.01600033261296, 95.80226589080772, 95.57204675052053, 95.32560885488024, 95.06324833720635, 94.78528028595153, 94.49202976282496, 94.18382551382733, 93.86099663984979, 93.52387231754827, 93.17278449494721, 92.80807333956463, 92.43009509639266, 92.0392319218635, 91.63590319774366, 91.22057779285232, 90.7937867259974, 90.35613568535888, 89.90831687292349, 89.45111966399399, 88.98543959961833, 88.83274198776269, 89.1969570824544, 89.55580221845716, 89.90808637805395, 90.25268629183823, 90.5885521825002, 90.91471221908024, 91.23027546219372, 91.53443313233075, 91.82645811089301, 92.10570267974755, 92.37159460968525, 92.62363180982474, 92.86137583733432, 93.08444463011985, 93.29250485749945, 93.48526428234288, 93.66246449391592, 93.82387430898494, 93.96928405817792, 94.09850088584571, 94.2113451060613, 94.30764758535733, 94.38724807244499, 94.44999437116638, 94.49574225597169, 94.52435605586155, 94.53570987600327, 94.5296894765447, 94.50619487473342, 94.4651437688104, 94.406475891589, 94.33015838247667, 94.23619221716002, 94.12461965669128, 93.99553257877272, 93.84908144348496, 93.68548453564601, 93.50503702941327, 93.30811935003604, 93.0952042731732, 92.86686221099349, 92.62376418930583, 92.36668211956933, 92.0964861076115, 91.81413870703562, 91.52068620639602, 91.21724722031725, 90.90499902068191, 90.58516218098706, 90.25898420386447, 89.9277228512604, 89.59262989598943, 89.25493596402309, 88.91583704487861, 88.5764831221962, 88.23796922970932, 87.90132908198987, 87.5675312769349, 87.23747792881653, 86.91200547527625, 86.82592389732523, 87.41231911968094, 87.99548451570516, 88.57343129602455, 89.14421997663229, 89.70597042527166, 90.2568709661088, 90.79518658724801, 91.3192662962214, 91.82754965332374, 92.31857248578002, 92.7909717529877, 93.24348950098107, 93.67497581923078, 94.08439070030424, 94.47080470645639, 94.93352575822071, 95.58382147717698, 96.18600110910891, 96.73848550753364, 97.23990293393067, 97.68910890702165, 98.08520122773862, 98.42752969410482, 98.71570031617242, 98.94957413865217, 99.12926105522364, 99.25510923390782, 99.32769095196323, 99.34778575165174, 99.31636187097558, 99.2345568779532, 99.1036583502083, 98.92508530479539, 98.7003709103974, 98.43114682103297, 98.11912927316283, 97.76610690161215, 97.37393006711275, 96.94450135987974, 96.47976685668047, 95.98170766710642, 95.45233130863025, 94.89366249674768, 94.45814971049037, 94.09054419293042, 93.70237738737775, 93.29427136988977, 92.8945452493207, 92.51473771335678, 92.12726070279511, 91.7330593870035, 91.33301289452508, 90.92792769243925, 90.5185311120263, 90.10546527343391, 89.68928167695027, 89.27043672380861, 88.84928840399465, 88.42609434319083, 88.00101133869816, 87.57409643965404, 87.14530954617584, 86.7145174219804, 86.28149894236105, 85.84595134027386, 85.91502520175622, 86.09637375213862, 86.2721397322291, 86.44150710745483, 86.60368807025196, 86.75792608156621, 86.90349829700361, 87.03971743252639, 87.16593315524077, 87.2815331066558, 87.3859436766211, 87.4786306450289, 87.5590997956897, 87.62689758425554, 87.68161191245764, 87.72287302777202, 87.75035453477093, 87.7637744755537, 87.76289641487918, 87.7475304531081, 87.71753408779003, 87.67281285244086, 87.61332067731928, 87.53905993946658, 87.45008119494995, 87.34648261198116, 87.22840914640628, 87.09605151857578, 86.94964506124563, 86.78946851132498, 86.61584281435877, 86.42913000082581, 86.22973217947155, 86.01809067708007, 85.79468533839072, 85.56003398598405, 85.31469202900726, 85.05925220196039, 84.79434441004669, 84.52063565480127, 84.23883001141016, 83.94966862575566, 83.6539296933822, 83.3524283733655, 83.04601657730355, 82.73558255800236, 82.42205020544027, 82.10637794153791, 81.78955709291192, 81.47260961506278, 81.15658504500338, 80.84255657419328, 80.5316161607849, 80.22486863936341, 79.92342483591382, 79.62839375271025, 79.34087394810417, 79.06194429495105, 78.79265435354806, 79.21559272836105, 79.7707116866128, 80.33441019338802, 80.90503387053339, 81.48090295530744, 82.06031873315962, 82.64157008147502, 83.22294013615783, 83.80271307907877, 84.37918102953381, 84.95065100918661, 85.51545193949072, 86.07194162477481, 86.61851367369935, 87.1536043164407, 87.67569908360817, 88.18333932367287, 88.67512854622457, 89.149738586162, 89.60591558672161, 90.04248579543064, 90.45836115594541, 90.85254466071918, 91.22413540608024, 91.57233326514621, 91.8964430682997, 92.19587815928895, 92.470163180821, 92.7189359396309, 92.94194820929263, 93.13906535009964, 93.3102646584245, 93.45563240100991, 93.57535953949518, 93.6697362032641, 93.73914502024088, 93.78405346155412, 93.80500539363682, 93.80261205786854, 93.77754271198711, 93.73051516908832]

print("Bessel: index:", xvec[list(res_enrgy1b).index(max(res_enrgy1b))],"value:", max(res_enrgy1b))
print("Cosine: index:", xvec[list(res_enrgy1c).index(max(res_enrgy1c))],"value:", max(res_enrgy1c))
fig = go.Figure()

fig.add_trace(go.Scatter(x = xvec, y = res_enrgy1b, name = '$\\large\\textrm{L}_{bessel}$', line = dict(color = 'black', width = 3)))
fig.add_trace(go.Scatter(x = xvec, y = res_enrgy1c, name = '$\\large\\textrm{L}_{cosine}$', line = dict(color = 'black', width = 3, dash = 'dot')))


fig.update_layout(
    font = dict(family = 'Times New Roman', color = 'black', size = 25),
    width = 700,
	height = 400,
    xaxis_title = 'Sampling (L)',
    yaxis_title = 'Energy (%)',
    plot_bgcolor = 'white'
)
fig.update_xaxes(
    mirror = True,
    ticks = 'outside',
    showline = True,
    linecolor = 'black',
    gridcolor = 'lightgrey',
    griddash = 'dot'
)
fig.update_yaxes(
    mirror = True,
    ticks = 'outside',
    showline = True,
    linecolor = 'black',
    gridcolor = 'lightgrey',
    griddash = 'dot'
)
fig.update_layout(legend=dict(yanchor="top", y=0.95, xanchor="left", x=0.75))
fig.update_traces(line = dict(width = 2.8, color = 'black'))
fig.write_image("calc_L2.png")
fig.show()
